<form class="form update-subscription-form" method="POST" action="{% url 'product_detail' product.id %}">
    {% csrf_token %}
    <div class="form-group">
        <select class="form-control mr-3 align-top" id="subscription_type_select" onchange="sub_select_func()" name="subscription">
            <option disabled selected>Select Subscription Type</option>
            {% for prod_sub in product_subscription %}
                <option value="{{ prod_sub.subscription_type.id }}">{{ prod_sub.subscription_type.name }}</option>
            {% endfor %}
        </select>        
        
        <input  id="selected_subscription_id" name="selected_subscription_id" >
        {% if sel_prod_sub != 'None' %}
        <div class="col-12">
            <p class="mt-3"><strong>Selected Subscription:</strong></p>
            <hr>
                {% for sel_prod_sub in sel_product_subscription %}
                    <p>Subscription: {{ sel_prod_sub.subscription_type.name }}</p>
                    <p>Price: {{ sel_prod_sub.price }}</p>
                    <p>Available Stock: {{ sel_prod_sub.quantity_available }}</p>
                    {% set sub_price = sel_prod_sub.price %}
                    
                {% endfor %}            
        </div>
        <!--input name="selected_subscription_price" value="{{sub_price}}"-->
        {% endif %}
    </div>
</form>
<div class="col-12"><a class="update-link text-info"><small>Update</small></a></div>
<hr>

{% block postloadjs %}
    <script type="text/javascript">
        $('.update-link').click(function(e) {
            //Get the selected subscription value and populate it to the hidden input
            var sel_sub = document.getElementById("subscription_type_select").value;
            //var sel_sub_price = sel_prod_sub.price;
            document.getElementById("selected_subscription_id").value = sel_sub;
            //document.getElementById("selected_subscription_price").value = {{sub_price}};
            //update the form with the selected subscription type details
            var form = $(this).parent().prev('.update-subscription-form');
            form.submit();
        })
    </script> 
{% endblock %}